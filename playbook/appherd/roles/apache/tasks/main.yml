---
- name: "update log format for source ip"
  become_user: "{{ remote_admin_account }}"
  become: yes
  template:
    src: ../templates/httpd.conf.j2
    dest: "/etc/httpd/conf/httpd.conf"
    backup: no
    owner: "root"
    group: "root"
    mode: 0644

- name: "setup docs directory for server"
  become_user: "{{ remote_admin_account }}"
  become: yes
  file:
    dest: "/var/www/doc/{{ cf_app_pyserver_name|lower }}"
    owner: root
    group: root
    state: directory
    mode: "0755"

- name: "give group ownership to httpd logs to logreader"
  become_user: "{{ remote_admin_account }}"
  become: yes
  file:
    dest: "/var/log/httpd"
    owner: root
    group: logreader
    state: directory
    mode: "0755"

- name: "start apache"
  become_user: "{{ remote_admin_account }}"
  become: yes
  service:
    name: httpd
    state: started
    enabled: yes
