---
vmware.vmware.guest_info:
  query: >-
    .guests[] | {
      name: .moid,
      canonical_facts: {
        name: .name,
        moid: .moid,
        esxi_host: .hw_esxi_host
      },
      facts: {
        device_type: "VM"
      }
    }, {
      name: .hw_esxi_host,
      facts: {
        device_type: "ESXi"
      }
    }

vmware.vmware.vm_list_group_by_clusters_info:
  query: >-
    .vm_list_group_by_clusters_info | values[] | values[] | values[] | {
      name: .moid,
      canonical_facts: {
        name: .name,
        moid: .moid,
        esxi_host: .hw_esxi_host
      },
      facts: {
        device_type: "VM"
      }
    }, {
      name: .hw_esxi_host,
      facts: {
        device_type: "ESXi"
      }
    }
