---
- name: Get Sensor Voltage information.
  ansible.builtin.uri:
    url: "https://{{ hostname }}:{{ https_port }}{{ api_chassis }}/Power#/Voltages"
  register: voltage_result
  delegate_to: "{{ idrac_gather_facts_delegate }}"

- name: Set Sensor Voltage facts
  ansible.builtin.set_fact:
    "voltages":
      "{{ voltage_result.json.Voltages | ansible.utils.remove_keys(
        target=['@odata.context', '@odata.id', '@odata.etag',
        '@odata.type']) }}"

- name: Error capture
  ansible.builtin.include_tasks:
    file: ./__capture_error.yml
  vars:
    register_vars:
      - "{{ voltage_result }}"
    component: 'sensors_voltage'
