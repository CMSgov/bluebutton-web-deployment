---
- name: Prepare system for Molecule tests
  hosts: all
  become: true
  tasks:
    - name: Install OMSDK using pip
      ansible.builtin.command: pip3 install omsdk
      register: omsdk_install
      changed_when: "'Successfully installed' in omsdk_install.stdout"

    - name: Install Netaddr using pip
      ansible.builtin.command: pip install netaddr
      register: netaddr_install
      changed_when: "'Successfully installed' in netaddr_install.stdout or 'Requirement already satisfied' in netaddr_install.stdout"

    - name: "Pre-requisites"
      ansible.builtin.include_tasks:
        file: "../resources/tests/downgrade.yml"
